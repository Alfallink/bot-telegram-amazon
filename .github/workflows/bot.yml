name: Bot Shopee Automático

on:
  # Agenda: diariamente às 10:00 UTC (07:00 horário de Brasília)
  schedule:
    - cron: '0 10 * * *'
  
  # Permite execução manual
  workflow_dispatch:
  
  # Executa no push (opcional)
  push:
    branches: [ main ]

jobs:
  executar-bot:
    runs-on: ubuntu-latest
    
    steps:
      # 1. Baixa o código
      - name: Baixar repositório
        uses: actions/checkout@v4
      
      # 2. Configura Python
      - name: Configurar Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      
      # 3. Instala dependências
      - name: Instalar bibliotecas
        run: |
          pip install --upgrade pip
          pip install requests
      
      # 4. Executa o bot
      - name: Executar Bot
        env:
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
          SHOPEE_AFILIADO_BASE: ${{ secrets.SHOPEE_AFILIADO_BASE }}
        run: |
          echo "Iniciando execução do bot..."
          python bot.py
          echo "Execução concluída!"
      
      # 5. (Opcional) Log de conclusão
      - name: Finalização
        run: echo "✅ Workflow concluído em $(date)"
